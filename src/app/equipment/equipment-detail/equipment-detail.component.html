<div class="container">
  <button (click)="goBack()" type="button" class="btn btn-default">
    go back
  </button>
</div>

@if (equipment) {
  <div class="container">
    <form #equipmentForm="ngForm" appUniqueEquipment (ngSubmit)="save()">
      <div [hidden]="equipmentForm.submitted">
        <div
          class="cross-validation"
          [class.cross-validation-error]="equipmentForm.errors?.['uniqueEquipment'] && (equipmentForm.dirty || equipmentForm.touched)"
          >
          <div><span> id: </span>{{ equipment.id }}</div>
          <h3>{{ equipment.name | uppercase }} Details</h3>
          <div class="form-group">
            <label for="name">
              Name
              <input
                type="text"
                id="name"
                name="name"
                class="form-control"
                required
                minlength="1"
                maxlength="42"
                [(ngModel)]="equipment.name"
                #name="ngModel"
                />
              @if (name.invalid && (name.dirty || name.touched)) {
                <div
                  class="alert alert-danger"
                  >
                  @if (name.errors?.['required']) {
                    <div>Name is required.</div>
                  }
                  @if (name.errors?.['minlength']) {
                    <div>
                      Name must be at least 1 character long.
                    </div>
                  }
                  @if (name.errors?.['maxlength']) {
                    <div>
                      Name must be at most 42 characters long.
                    </div>
                  }
                </div>
              }
            </label>
          </div>
          <div class="form-group">
            <label for="price">
              Price
              <input
                type="number"
                id="price"
                name="price"
                class="form-control"
                required="required"
                min="0.01"
                max="99999999998.99"
                [(ngModel)]="equipment.price"
                #price="ngModel"
                step="0.01"
                />
              @if (price.invalid && (price.dirty || price.touched)) {
                <div
                  class="alert alert-danger"
                  >
                  @if (price.errors?.['required']) {
                    <div>Price is required.</div>
                  }
                  @if (price.errors?.['min']) {
                    <div>
                      Price must be at least 0.01.
                    </div>
                  }
                  @if (price.errors?.['max']) {
                    <div>
                      Price must be at most 99999999998.99.
                    </div>
                  }
                </div>
              }
            </label>
          </div>
          @if (equipmentForm.pending) {
            <div>Validating...</div>
          }
          @if (equipmentForm.errors?.['uniqueEquipment']) {
            <div
              class="cross-validation-error-message alert alert-danger equipment-errors"
              >
              Equipment is already registered.
            </div>
          }
        </div>
        <p>Make valid changes to enable the Update button.</p>
        <button
          type="submit"
          [disabled]="equipmentForm.invalid"
          class="btn btn-success"
          >
          Update
        </button>
      </div>
      @if (equipmentForm.submitted) {
        <div class="submitted-message">
          <p>You've submitted your equipment, {{ equipmentForm.value.name }}!</p>
          <button
            type="button"
            (click)="equipmentForm.resetForm({ name: '', price: 0 })"
            class="btn btn-success"
            >
            Add new equipment
          </button>
        </div>
      }
    </form>
  </div>
}
